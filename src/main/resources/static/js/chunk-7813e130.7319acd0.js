(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7813e130"],{"159b":function(t,e,a){var s=a("da84"),i=a("fdbc"),o=a("17c2"),r=a("9112");for(var l in i){var n=s[l],d=n&&n.prototype;if(d&&d.forEach!==o)try{r(d,"forEach",o)}catch(c){d.forEach=o}}},"17c2":function(t,e,a){"use strict";var s=a("b727").forEach,i=a("a640"),o=a("ae40"),r=i("forEach"),l=o("forEach");t.exports=r&&l?[].forEach:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}},2569:function(t,e,a){"use strict";var s=a("bdfd"),i=a.n(s);i.a},4160:function(t,e,a){"use strict";var s=a("23e7"),i=a("17c2");s({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},"4de4":function(t,e,a){"use strict";var s=a("23e7"),i=a("b727").filter,o=a("1dde"),r=a("ae40"),l=o("filter"),n=r("filter");s({target:"Array",proto:!0,forced:!l||!n},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"7f3a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"model"},[a("div",{staticStyle:{width:"50%",height:"100%",background:"#fff"}},[a("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.htmlUrl}})]),a("div",{staticClass:"dialogDiv"},[a("div",{staticClass:"dialogDiv1"},[a("p",[t._v("数据源名称： "),a("Select",{staticClass:"selector",staticStyle:{width:"200px"},on:{"on-select":t.selectChange},model:{value:t.tableName,callback:function(e){t.tableName=e},expression:"tableName"}},t._l(t.databasesList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.databaseName))])})),1)],1)]),a("div",{staticClass:"dialogDiv2"},[a("div",{staticStyle:{width:"20%",height:"494px",overflow:"auto","border-right":"1px solid #999"}},[a("List",{staticStyle:{width:"100%",height:"100%"},attrs:{header:"数据表",size:"small"}},t._l(t.tablesList,(function(e,s){return a("ListItem",{key:s,class:t.active==s?"addclass":"",nativeOn:{click:function(e){return t.getFieldsList(s)}}},[t._v(t._s(e))])})),1)],1),a("div",{staticStyle:{width:"80%"}},[a("Table",{attrs:{data:t.tableData,columns:t.columns3,height:"400"}})],1)]),a("div",{staticClass:"dialogDiv3"},[a("Form",{ref:"form",attrs:{model:t.form}},[a("FormItem",[a("Input",{attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:t.form.textarea,callback:function(e){t.$set(t.form,"textarea",e)},expression:"form.textarea"}})],1),a("FormItem",[a("Input",{attrs:{type:"textarea",rows:3,disabled:""},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}})],1),a("FormItem",{staticClass:"buttonGro"},[a("Button",{staticClass:"sqltestBtn",attrs:{disabled:t.disable,type:"primary",size:"small"},on:{click:t.sqlTest}},[t._v("绑定测试")]),a("Button",{attrs:{type:"primary",disabled:t.disable1,size:"small"},on:{click:t.submitSql}},[t._v("保存")])],1)],1)],1)])])},i=[],o=(a("4de4"),a("4160"),a("c975"),a("b64b"),a("d3b7"),a("25f0"),a("159b"),a("ade3")),r=(a("bc3a"),a("4328"),{name:"model",data:function(){var t;return t={dialogVisible:!1,disable:!0,disable1:!0,listArr:[],tableData:[],form:{textarea:""}},Object(o["a"])(t,"tableData",[]),Object(o["a"])(t,"active",-1),Object(o["a"])(t,"datafrom",{identifierName:"",sqlContext:"",templateId:43}),Object(o["a"])(t,"columns3",[{title:"字段名称",key:"fieldName"},{title:"字段类型",key:"fieldType"},{title:"字段描述",key:"fieldDes"}]),Object(o["a"])(t,"srcurl",""),Object(o["a"])(t,"sqlIndex",""),Object(o["a"])(t,"tableName",this.$store.state.templateMsg.sourceId?this.$store.state.templateMsg.sourceId:""),Object(o["a"])(t,"databasesList",[]),Object(o["a"])(t,"tablesList",[]),Object(o["a"])(t,"tableData",[]),Object(o["a"])(t,"targetArr",[]),Object(o["a"])(t,"updataSqlarr",[]),Object(o["a"])(t,"allA",[]),Object(o["a"])(t,"result",""),t},watch:{sqlIndex:{handler:function(t,e){var a=this;t&&(this.disable=!1),console.log(this.targetArr),console.log("00000000",this.$store.state.templateMsg),console.log("popoppop",t),this.$api.FIND_SQL("/findSQL",{identiferName:t,templateId:this.$store.state.templateMsg.templateId}).then((function(t){console.log("hdshdjsdhjsd",t),t.data.body&&(a.form.textarea=t.data.body)}))}},tableName:{handler:function(t){console.log("newVal",t)}}},computed:{htmlUrl:function(){return this.$store.state.templateMsg.htmlUrl}},created:function(){var t=this;console.log(this.$store.state.templateMsg),this.$store.state.templateMsg.sourceId&&this.$api.LIST_DB_SOURCE_TABLES("/listDBSourceTables",{sourceId:this.$store.state.templateMsg.sourceId,templateId:this.$store.state.templateMsg.templateId}).then((function(e){console.log("ziduan",e.data.body),t.tablesList=e.data.body}));var e=this;window.a=function(a){console.log("00000000000000000000",a),t.sqlIndex=a.toString(),t.targetArr.push(t.sqlIndex),t.targetArr=t.targetArr.filter((function(t,e,a){return a.indexOf(t)===e})),t.$api.FIND_SQL("/findSQL",{identiferName:t.sqlIndex,templateId:t.$store.state.templateMsg.templateId}).then((function(e){console.log("hdshdjsdhjsd",e),e.data.body&&(t.form.textarea=e.data.body)})),e.changeNodeMsg(a)},window.sqldata=[],this.$api.LIST("/list").then((function(e){console.log("table:",e.data.body),t.databasesList=e.data.body}))},mounted:function(){var t=document.getElementsByTagName("iframe")[0];t.onload=function(){this.allA=t.contentWindow.document.getElementsByTagName("a"),window.sqldata=this.allA}},methods:{submitSql:function(){var t=this;this.disable1=!0,this.$api.UPDATE_SQL("/updateSql",{identifierArray:this.updataSqlarr,sqlContext:this.form.textarea.toString(),templateId:this.$store.state.templateMsg.templateId}).then((function(e){"sql映射成功"==e.data.body&&(t.$Message.success("保存成功"),t.updataSqlarr=[]),console.log("qqqqqqqqqqq",e)}))},sqlTest:function(){var t=this;console.log(this.targetArr),this.$api.SQL_QUERY("/sqlTest",{identifierArray:this.targetArr,dbSourceId:this.$store.state.templateMsg.sourceId,sql:this.form.textarea.toString()}).then((function(e){console.log("sql结果",e.data.body),t.result=JSON.stringify(e.data.body),"sql查询结果与X下标不一致"==e.data.body?(t.disable1=!0,t.targetArr=[],console.log(t.targetArr)):(t.disable1=!1,t.updataSqlarr=t.targetArr,t.targetArr=[],Object.keys(e.data.body).forEach((function(t){sqldata[t].innerHTML=e.data.body[t],console.log(t,e.data.body[t])})))}))},changeNodeMsg:function(t){this.dialogVisible=!0,this.datafrom.identifierName=t,this.form.textarea=this.datafrom.sqlContext;var e=JSON.stringify(this.datafrom);console.log("sdasdasdasdasd",this.$store.state.templateMsg),this.srcurl=this.$store.state.templateMsg.htmlUrl,console.log(e),this.createTag()},createTag:function(){document.getElementsByClassName("dialogDiv1")[0]},clickItem:function(t){console.log(t),this.active=t},handleClose:function(t){t()},selectChange:function(t){var e=this;console.log("val",t),this.$api.LIST_DB_SOURCE_TABLES("/listDBSourceTables",{sourceId:t.value,templateId:this.$store.state.templateMsg.templateId}).then((function(t){console.log("ziduan",t.data.body),e.tablesList=t.data.body}))},getFieldsList:function(t){var e=this;this.active=t,console.log("indsdasdasd",t),this.$api.LIST_TABLE_COLUMN("/listTableColumn",{tableName:this.tablesList[t],sourceId:this.tableName}).then((function(t){console.log("shujuliebiao",t.data.body),e.tableData=t.data.body}))}}}),l=r,n=(a("2569"),a("2877")),d=Object(n["a"])(l,s,i,!1,null,"34e5ca01",null);e["default"]=d.exports},a640:function(t,e,a){"use strict";var s=a("d039");t.exports=function(t,e){var a=[][t];return!!a&&s((function(){a.call(null,e||function(){throw 1},1)}))}},ade3:function(t,e,a){"use strict";function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a.d(e,"a",(function(){return s}))},b64b:function(t,e,a){var s=a("23e7"),i=a("7b0b"),o=a("df75"),r=a("d039"),l=r((function(){o(1)}));s({target:"Object",stat:!0,forced:l},{keys:function(t){return o(i(t))}})},bdfd:function(t,e,a){},c975:function(t,e,a){"use strict";var s=a("23e7"),i=a("4d64").indexOf,o=a("a640"),r=a("ae40"),l=[].indexOf,n=!!l&&1/[1].indexOf(1,-0)<0,d=o("indexOf"),c=r("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:n||!d||!c},{indexOf:function(t){return n?l.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-7813e130.7319acd0.js.map